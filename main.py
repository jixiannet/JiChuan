# 版权信息
# 即现（信阳）网络科技有限公司 版权所有
# https://www.jixiannet.com
# 2024年06月06日
import base64
import tkinter as tk
from tkinter import filedialog, messagebox
from http.server import HTTPServer, BaseHTTPRequestHandler, SimpleHTTPRequestHandler
from socketserver import ThreadingMixIn
import threading
import os
from PIL import Image, ImageTk
from io import BytesIO
from urllib.parse import unquote

DEFAULT_IP = "127.0.0.1"
DEFAULT_PORT = 8765
server_instance = None  # 存储HTTP服务器实例的引用
stop_event = threading.Event()  # 控制HTTP服务器退出的事件标志

def select_folder():
    """选择文件夹的回调函数。"""
    folder_selected = filedialog.askdirectory()
    entry_folder_path.delete(0, tk.END)
    entry_folder_path.insert(0, folder_selected)


class GracefulHTTPRequestHandler(BaseHTTPRequestHandler):
    def translate_path(self, path):
        global folder_path
        return os.path.join(folder_path, path.lstrip('/'))


class ThreadedHTTPServer(ThreadingMixIn, HTTPServer):
    daemon_threads = True  # 设置线程为守护进程，随主程序结束而结束


def serve_http():
    """启动HTTP文件服务器的回调函数，运行在新线程内。"""
    global server_thread
    folder_path = entry_folder_path.get()
    ip = entry_ip.get()
    port = int(entry_port.get())

    if not os.path.isdir(folder_path):
        messagebox.showerror("错误", "请选择一个有效的文件夹路径")
        return

    class CustomHTTPRequestHandler(SimpleHTTPRequestHandler):
        def translate_path(self, path):
            # 使用unquote对路径进行解码，确保中文等字符能够正确处理
            path = unquote(path, errors='ignore')
            folder_path = entry_folder_path.get()  # 获取文件夹路径
            return os.path.join(folder_path, path.lstrip('/'))

    handler = CustomHTTPRequestHandler

    try:
        server_address = (ip, port)
        httpd = HTTPServer(server_address, handler)
        sa = httpd.socket.getsockname()
        print(f"Serving HTTP on {sa[0]} port {sa[1]} ...")
        server_thread = threading.Thread(target=httpd.serve_forever)
        server_thread.daemon = True  # 设置为守护线程，主程序结束时自动结束
        server_thread.start()
    except Exception as e:
        messagebox.showerror("错误", str(e))


def start_http_server():
    """启动HTTP文件服务器的回调函数，运行在新线程内。"""
    global folder_path
    folder_path = entry_folder_path.get()
    if not os.path.isdir(folder_path):
        messagebox.showerror("错误", "请选择一个有效的文件夹路径")
        return

    thread = threading.Thread(target=serve_http, daemon=True)
    thread.start()


def stop_http_server():
    """停止HTTP服务器的函数。"""
    global stop_event, server_instance
    stop_event.set()  # 设置事件，通知服务器线程停止
    if server_instance:
        server_instance.shutdown()  # 使用shutdown方法优雅关闭服务器
        server_instance.server_close()  # 关闭服务器的socket
        server_instance = None


def on_closing():
    """窗口关闭时调用的函数，确保HTTP服务器线程被正确停止。"""
    stop_http_server()
    root.quit()  # 使用quit而非destroy，以确保Tkinter主循环正常结束


# 创建GUI
root = tk.Tk()
root.title("即传 - 文件共享工具 V1.0")
# 在这里先不设置窗口大小，等到计算居中后再设置

# Base64编码的图像数据
base64_image_data = 'iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAYAAADL1t+KAAAACXBIWXMAAAsTAAALEwEAmpwYAAAG4WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDI0LTA2LTA2VDIwOjMzOjE3KzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wNi0wNlQyMDozODoxOSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNC0wNi0wNlQyMDozODoxOSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0OWZkYjg0My04Yzc2LWRjNGEtYjAyYi01ODIzYTZjMGVhNjciIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozMzg1MjZlYy0wN2I5LWY2NDktOTkzMi05OWJhNjk3NGFjNmUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo5ZDdlMGI4Yy0xMmU3LTVlNGEtYmJkZi1mNTc4MjQyZTBkYTIiPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6NGRmZGUzMTgtMzQzOC00YTRjLThlNjgtZDM5NjBkMzY0M2Q2PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OWQ3ZTBiOGMtMTJlNy01ZTRhLWJiZGYtZjU3ODI0MmUwZGEyIiBzdEV2dDp3aGVuPSIyMDI0LTA2LTA2VDIwOjMzOjE3KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBpbWFnZS9ibXAgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo0OWZkYjg0My04Yzc2LWRjNGEtYjAyYi01ODIzYTZjMGVhNjciIHN0RXZ0OndoZW49IjIwMjQtMDYtMDZUMjA6Mzg6MTkrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4wIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz78bdBTAABJTklEQVR4nO3deZxcZ33n+89zqqr3TS21VkuyFkvyjnfL2MZgY3YIWyAEsrAkGchGmJk7c+fembnzusmdhARISCAhELYwbMEhgTEEjPGCN1m2ZMubLMmy9r2lbvVaVec8949zqrq61eq1Tp2lvu+Xy+qurjr1q67q863nOc/zHGOtRURERJLNiboAERERmT8FuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBRToIiIiKaBAFxERSQEFuoiISAoo0EVERFJAgS4iIpICCnQREZEUUKCLiIikgAJdREQkBbJRFzCZ7ofmdj8DYM/zwwnXn/e2/nVtQJuB1cBFWDLANfjfNwFOcN3Ytqbe3thtprjddLcxE6+byXOaeJuZ1Hiebcz55xMfd5L7T/Xcp3re0z3nqX5+np9lgD4D3wMexHIS6J9RrTN4DcNw6d79U99gsvfJDG870+1Ouc3ZbnfiNmd732luf06tc3zO0253Ltufx/1N8H8LeDgYCwYPDBTJUqCRHCM0mBFGaMEYF4OLNeAaB48MXo3beMNDS/wvZrJPPN/tznfbWbjn8/O4c4zEMtAj0gMsBW4HrgCuBq6MtCKJ0luAo8C9wM+AB4GXgUKENYmInFe9B3oWP7RvB24BbgK6I61I4mQp8L7g8iLwQ+BfgK3AUIR1iYico14DvQV4FfB24PXAymjLkQTYAPwR8BH8UP86fsvdjbIoEZGSegz0twIfxA/0rmhL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'

# 将Base64编码解码为字节
image_data = base64.b64decode(base64_image_data)

# 使用BytesIO和PIL的Image.open来加载图像数据
image = Image.open(BytesIO(image_data))
photo_image = ImageTk.PhotoImage(image)
# 设置图标（使用PNG文件）
# image = ImageTk.PhotoImage(file="logo.png")  # 确保logo.png在当前目录
root.iconphoto(True, photo_image)

# 绑定窗口关闭事件
root.protocol("WM_DELETE_WINDOW", on_closing)

# 自定义样式
style = {'font': ('Arial', 12), 'bg': '#F0F0F0', 'fg': '#333333'}

tk.Label(root, text="监听IP地址", **style).pack(pady=5)
entry_ip = tk.Entry(root, **style)
entry_ip.pack(fill=tk.X, padx=20)
entry_ip.insert(tk.END, DEFAULT_IP)

tk.Label(root, text="端口", **style).pack(pady=5)
entry_port = tk.Entry(root, **style)
entry_port.pack(fill=tk.X, padx=20)
entry_port.insert(tk.END, str(DEFAULT_PORT))

tk.Label(root, text="选择文件夹", **style).pack(pady=5)
entry_folder_path = tk.Entry(root, **style)
entry_folder_path.pack(fill=tk.X, padx=20)

browse_button = tk.Button(root, text="浏览", command=select_folder, bg="#4CAF50", fg="white", relief=tk.FLAT, padx=10,
                          pady=5, font=('Arial', 10))
browse_button.pack(pady=5)

start_share_button = tk.Button(root, text="开始共享", command=start_http_server, bg="#007bff", fg="white",
                               relief=tk.FLAT, padx=10, pady=5, font=('Arial', 10))
start_share_button.pack(pady=10)

# 更新窗口配置，确保所有配置都已经应用
root.update_idletasks()

# 获取屏幕宽度和高度
screen_width = root.winfo_screenwidth()
screen_height = root.winfo_screenheight()

# 获取窗口宽度和高度
# = root.winfo_width()
#window_height = root.winfo_height()
# 获取窗口宽度和高度
window_width = 350
window_height = 260

# 计算居中位置
x_coordinate = int((screen_width/2) - (window_width/2))
y_coordinate = int((screen_height/2) - (window_height/2))

# 设置窗口大小和位置
root.geometry(f"{window_width}x{window_height}+{x_coordinate}+{y_coordinate}")

root.mainloop()